<!DOCTYPE html>
<html>
<head>
	<title>DIA-Umpire</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="shortcut icon" type='image/x-icon' href="/img/favicon.ico">
	<link rel="stylesheet" type="text/css" href="/docs/css/external/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/docs/css/normalize.css">
	<link rel="stylesheet" type="text/css" href="/docs/css/font-awesome/css/font-awesome.min.css">

	<link rel="stylesheet" type="text/css" href="/docs/css/solarized_dark.css">
	<link rel="stylesheet" type="text/css" href="/docs/css/tutorials.css">
	<link rel="stylesheet" type="text/css" href="/docs/css/style.css">
	<link rel="stylesheet" type="text/css" href="/docs/css/toc.css">

	
		<link rel="stylesheet" href="/docs/{{site.baseurl}}/css/tutorials.css">
	
		<link rel="stylesheet" href="/docs/{{site.baseurl}}/css/solarized_dark.css">
	

	<!-- needed for tutorial specific css -->
	
</head>
<body>	
	

	<!--
	<div class="container" id="main-container">
		<div class="topNavbar">
			<div class="navbar-div" id="logo">
			<a class="logoLink" href="/">BIOJS</a>
			</div>
			<div class="navbar-div" id="navbar-links2">
				<li>
			
			</div>
		</div>
	-->


    <div id="biojs-menu">
<div class="Menu">
        <div class="list">
            <div class="logoDiv">
                <img src="/docs/img/logo.png" id="logoImg">
                <div class="logoDivName">BioContainers Edu.</div>
            </div>


        <span class="item-heading"> Basics </span>
			
	
				<a class="item " href="/docs/101/intro/">Intro</a>
			
	
				<a class="item " href="/docs/101/what_is_biocontainers/">BioContainers?</a>
			
	
				<a class="item " href="/docs/101/getting_started/">Getting started</a>
			
	
				<a class="item " href="/docs/101/docker-nutshell/">Docker in NutShell</a>
			
	
				<a class="item " href="/docs/101/biocontainers-architecture/">BioContainers Architecture</a>
			
	
				<a class="item " href="/docs/101/running-example/">BioContainer example</a>
			
	
				<a class="item " href="/docs/101/biocontainers-registry/">Registry UI</a>
			
		

        <span class="item-heading"> Developer tutorial </span>
			
	
				<a class="item " href="/docs/developer-manual/biocotainers-dockerfile/">Dockerfile Template</a>
			
	
				<a class="item " href="/docs/developer-manual/best-practices/">Best Practices</a>
			
	
				<a class="item " href="/docs/developer-manual/biocontainers-input-output/">Input/Outpout</a>
			
	
				<a class="item " href="/docs/developer-manual/deploy-dockerhub/">Deploy to DockerHub</a>
			
		

        <span class="item-heading"> BioContainers FAQS </span>
			
	
				<a class="item " href="/docs/faqs/manually-remove-dockerboot/">Remove boot2docker</a>
			
		

        <span class="item-heading"> Containers Examples </span>
			
	
				<a class="item item-active" href="/docs/containers-examples/DIAUmpire/">DIA-Umpire</a>
			
	
				<a class="item " href="/docs/containers-examples/Comet/">Comet</a>
			
		
    </div>
</div>

	</div>

	<div id="biojs-main-content">
		
		<div class="heading row">
   
  <div class="col-md-6 col-xs-7 col-lg-5" id="contentTitleCell">
	  <span class="contentTitle">DIA-Umpire </span>

	  <a class="gitStar" style="width:150px;" href="https://github.com/biocontainers/edu/blob/master/series/containers-examples/10_DIAUmpire.md" target="_blank"><span class="glyphicon glyphicon-pencil" style="font-size:14px;" ></span> Improve this page</a>
  </div>

	<div class="col-xs-2 col-md-3">
		<div id="biojs-iconnav-glyphs">
	  <a class="git" href="https://github.com/biocontainers/" target="_blank"><i class="fa fa-github-alt"></i></a>

	  <a class="git"  href="http://biocontainers.pro" target="_blank"><i class="fa fa-home"></i></a>
	  <a class="git hidden-xs hidden-sm" href="https://kiwiirc.com/client/irc.freenode.net/biocontainers" target="_blank"><i class="fa fa-weixin"></i></a>
	  <a class="git hidden-xs hidden-sm" id="bookmark-link" href="#"><i class="fa fa-bookmark"></i></a>

  </div>	

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
    $('#bookmark-link').click(function() {
        if (window.sidebar && window.sidebar.addPanel) { // Mozilla Firefox Bookmark
            window.sidebar.addPanel(document.title,window.location.href,'');
        } else if(window.external && ('AddFavorite' in window.external)) { // IE Favorite
            window.external.AddFavorite(location.href,document.title); 
        } else if(window.opera && window.print) { // Opera Hotlist
            this.title=document.title;
            return true;
        } else { // webkit - safari/chrome
            alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != - 1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
        }
    });
});
</script>

	  <a class="gitStar hidden-xs hidden-sm" style="width:150px;" id="biojs-iconnav-help" href="https://gitter.im/biocontainers/Lobby" target="_blank"><span class="glyphicon glyphicon-bullhorn" style="font-size:17px;" ></span> Get help</a>

  </div>	
  <div class="col-md-2 col-lg-2 hidden-xs hidden-sm" id="social-media-share">

    <!-- share it: twitter, google -->
    <div style="height:25px"> <a href="https://twitter.com/share" class="twitter-share-button" style="width: 40px">Tweet</a>

      <script>
        ! function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0],
                    p = /^http:/.test(d.location) ? 'http' : 'https';
                if (!d.getElementById(id)) {
                    js = d.createElement(s);
                    js.id = id;
                    js.src = p + '://platform.twitter.com/widgets.js';
                    fjs.parentNode.insertBefore(js, fjs);
                }
            }(document, 'script', 'twitter-wjs');
      </script>
      <script src="https://apis.google.com/js/platform.js" async defer></script>
	  <div class="share-google-button">
      	<div class="g-plus" data-action="share" data-annotation="bubble"
      data-align="right"></div>
	  </div>
    </div>

    </div>
	

    <div class="author col-md-2 col-xs-2 hidden-xs">
			<div class="tutorial-item"><span class="glyphicon glyphicon-calendar" style="font-size:14px;margin-bottom: 2px;"></span> 27 Oct 2016</div>
	        
			
	        <div class="tutorial-item"><span class="glyphicon glyphicon-time" style="font-size:14px;margin-bottom: 2px;"></span> 5 minutes </div>
	        
	</div>

</div>

<div class="pullButton pullButton-mob">
	<i class="fa fa-bars fa-2x"></i>
</div>


<div class="containerBody">
	<!--
    <div class="leftPanel">

		

    </div>
	-->
    <div class="rightPanel">



        <div class="static-content">

            <div id="explanation" style="display:none">
                <div style="display:block"><div class="tutorials-highlight" style="display:block;"><span class="glyphicon glyphicon-check" style="float:left;display:block;margin-right:20px"></span><div class="tutorials-highlight-text">
<p>We will use this icon to mark check points.
A check point is a way for you to check how you are doing.</p>
</div></div></div>

<div style="display:block"><div class="tutorials-highlight" style="display:block;"><span class="glyphicon glyphicon-minus-sign" style="float:left;display:block;margin-right:20px"></span><div class="tutorials-highlight-text">
<p>For most of the steps in this tutorial we will
provide the code as it should look after the task. It is tempting, we
know, but please, please, do not go for the “copy&amp;paste” way.</p>
</div></div></div>

<div style="display:block"><div class="tutorials-highlight" style="display:block;"><span class="glyphicon glyphicon-road" style="float:left;display:block;margin-right:20px"></span><div class="tutorials-highlight-text">
<p>We will use this icon to challenge you
with additional code-related tasks so you can go further at your own
pace. No inline answer will be provide for those challenges but we will
give you some guidelines and tips. By the way, within the instructions
we will use <em>an italic font</em> to refer to variables and pieces of code.</p>
</div></div></div>

<div style="display:block"><div class="tutorials-highlight" style="display:block;"><span class="glyphicon glyphicon-bell" style="float:left;display:block;margin-right:20px"></span><div class="tutorials-highlight-text">
<p>We will use this icon to ask you some questions related to the task your are working on.</p>
</div></div></div>

<div style="display:block"><div class="tutorials-highlight" style="display:block;"><span class="glyphicon glyphicon-info-sign" style="float:left;display:block;margin-right:20px"></span><div class="tutorials-highlight-text">
<p>Additional info and resources - this is not essential to complete the tutorial, but very interesting.</p>
</div></div></div>

<div style="display:block"><div class="tutorials-highlight" style="display:block;"><span class="glyphicon glyphicon-gift" style="float:left;display:block;margin-right:20px"></span><div class="tutorials-highlight-text">
<p>Tips that might help you on this task.</p>
</div></div></div>

<div style="display:block"><div class="tutorials-highlight" style="display:block;"><span class="glyphicon glyphicon-hand-up" style="float:left;display:block;margin-right:20px"></span><div class="tutorials-highlight-text">
<p>If you are following this tutorial as part of a workshop, do not hesitate to
raise your hand and share any questions or comments you may have.
If you are doing it by your own, you still can raise your hand in our
mailing list, just join our <a href="https://groups.google.com/forum/#!forum/biojs">Google Group</a>.</p>
</div></div></div>


            </div>

            <div class="clearfix"> </div>

<!--

-->
            <p>In this example I am going to demonstrate the importance of Docker through the use of a complex and powerful pipeline called DIA-Umpire. In this example I will demonstrate how to download, run and obtain the results from the DIA-Umpire pipeline.</p>

<h2 id="what-do-we-have">What do we have</h2>

<p>The DIA-Umpire container has the following programs installed:</p>

<ul>
  <li>
    <p>DIA-Umpire v1.4256</p>
  </li>
  <li>
    <p>TPP v4.8.0</p>
  </li>
  <li>
    <p>Comet v2015010</p>
  </li>
</ul>

<h2 id="what-do-you-need">What do you need</h2>

<p>Before start, you will need Docker installed on your computer. There are several ways to run Docker, go to the official <a href="https://docs.docker.com/installation/">website</a> and follow the instructions on how to install it.
In order to make this analysis you will need:</p>

<ul>
  <li>converted raw files.</li>
  <li>a fasta file for the database search.</li>
  <li>parameter files for the pipeline (see below)</li>
</ul>

<h2 id="getting-the-container">Getting the container</h2>

<p>The first step is to download the DIA-Umpire image that is available in the BioDocker repositories:</p>

<pre><code>$ docker pull biodckr/dia-umpire
</code></pre>

<p>This command will download the container to your machine. Now we need to set up a folder to be our work space, and inside this folder, create another folder called <code>input</code>:</p>

<pre><code>$ mkdir /workspace/
$ mkdir /workspace/input/
</code></pre>

<p>The workspace folder will be where we are going to execute all commands from now on.</p>

<h2 id="getting-the-parameter-files">Getting the parameter files</h2>

<p>To run the pipeline we need some parameter files from the different program we will run. Go to the <a href="https://github.com/BioDocker/containers/tree/master/DIA-Umpire/1.4256/input">DIA-Umpire repository</a>, download all 4 files there, and place them inside the <code>input</code> folder.</p>

<h3 id="a-note-about-sharing-folders-with-containers">a note about sharing folders with containers</h3>

<p>During the steps below we are going to use a specific docker parameter that allows us to map folders from our computer inside the containers. That way, the software inside the containers can have access to files in this specific folder and vice-versa. This is how we pass parameter files and retrieve results. Check <a href="https://github.com/BioDocker/biodocker/wiki/Using-input--and-Output-files">here</a> for a more detailed explanation.</p>

<h2 id="run-dia-umpire-signal-extraction">1) Run DIA-Umpire Signal Extraction</h2>

<ul>
  <li>
    <p>Open the diaumpire.se_params parameter file and set the values you need.</p>
  </li>
  <li>
    <p>Define how much memory you will allow DIA-Umpire to use by setting the <code>-Xmx8G</code> parameter (see below). In this example I’m giving 8Gb to the program execution.</p>
  </li>
</ul>

<p>The analysis starts by running the DIA-Umpire program with our converted raw file, the command can look scary at first because it looks big, but this is because we are mapping folders inside the container, check the command below and then lets take a look at it in detail:</p>

<pre><code>$ docker run -v /home/felipevl/workspace/input:/data/ biodckr/dia-umpire java -jar -Xmx8G /home/biodocker/bin/DIA-Umpire/DIA_Umpire_SE.jar /data/sample.mzXML /data/diaumpire.se_params
</code></pre>

<h3 id="explaining-the-command">explaining the command</h3>

<p><code>docker run</code>: is the command to execute the docker program`.</p>

<p><code>-v /home/felipevl/workspace/input:/data/</code>: this docker parameter is telling to the container that we have a folder called <code>input/</code> that must be mapped inside, into a folder called <code>/data/</code>. That way, inside the container, a folder called <code>/data/</code> will be created automatically and it will share file with our folder called <code>input</code>/.</p>

<p>Have in mind that the container do not see the folder <code>/home/felipevl/workspace/input</code>, that’s how we see the files, inside the container they will be at <code>/data/</code>.</p>

<p><code>biodckr/dia-umpire java -jar -Xmx8G DIA_Umpire_SE.jar /data/sample.mzXML /data/diaumpire.se_params</code>: this last part tells that we want to execute our biodckr/dia-umpire container and, inside the container, we want to run the those commands to execute our program.</p>

<p>If everything goes OK you should see several new files in the input folder and the <code>Job complete</code> message in your terminal.</p>

<h2 id="converting-mgf-files-to-mzxml">2) Converting mgf files to mzXML</h2>

<p>The Analysis will generate several files, between them the ones we need to continue with the pipeline, that is, the <code>.mgf</code> files. The fist step create 3 new files:</p>

<ul>
  <li>
    <p><code>sample_Q1.mgf</code></p>
  </li>
  <li>
    <p><code>sample_Q2.mgf</code></p>
  </li>
  <li>
    <p><code>sample_Q3.mgf</code></p>
  </li>
</ul>

<p>Now we need to convert those files to a format compatible with Comet:</p>

<pre><code>$ docker run -v /home/felipevl/workspace/input:/data/ biodckr/dia-umpire /usr/local/tpp/bin/msconvert --mzXML /data/*.mgf -o /data/
</code></pre>

<p>this command uses a program called msconvert, from the ProteoWizard library, present in the TPP installation. This will create a new .mzXML file for each .mgf file we have. Don’t forget to always use the internal path <code>/data/</code> to save the files to the correct place.</p>

<h2 id="run-a-database-search-with-comet">3) Run a Database Search with Comet</h2>

<p>Having all the files in the correct format we can now run the database search using Comet. Don’t forget to adjust the <em>comet.params</em> file with the desired values.</p>

<pre><code>$ docker run -v /home/felipevl/workspace/input:/data/ biodckr/dia-umpire comet.2015010.linux.exe -P/data/comet.params /data/sample_Q1.mzXML /data/sample_Q2.mzXML /data/sample_Q3.mzXML
</code></pre>

<h2 id="run-peptideprophet-and-proteinprophet-from-tpp-xinteract-on-comet-results">4) Run PeptideProphet and ProteinProphet from TPP Xinteract on Comet Results</h2>

<p>Comet analysis will result in a <em>pep.xml</em> file for each <code>mzXML</code> we have. In these case we ave now:</p>

<ul>
  <li>
    <p><code>sample_Q1.pep.xml</code></p>
  </li>
  <li>
    <p><code>sample_Q2.pep.xml</code></p>
  </li>
  <li>
    <p><code>sample_Q3.pep.xml</code></p>
  </li>
</ul>

<p>Now we have to run the TPP program called PeptideProphet <code>xinteract</code> with  in order to combine theses results.</p>

<p>In the next step when we run <code>ProteinProphet</code>, the program is expecting to see files beginning with <em>interact-</em>, so in these case we are naming our results using this prefix. Note that the parameters defined here for <code>xinteract</code> and <code>PeptideProphet</code> were selected because of the files I have and how the analysis was done. You will have to check the program documentation to set the appropriate parameters for your files.</p>

<p>Also note that we have to run this command individually for each <em>pep.xml</em> file.</p>

<p>~~~<code>
$ docker run -v /home/felipevl/workspace/input:/data/ biodckr/dia-umpire /usr/local/tpp/bin/xinteract -OpdEAP -PPM -drev -N/data/interact-sample_Q1.pep.xml /data/sample_Q1.pep.xml</code>
~~~</p>

<p>ProteinProphet also is called from the <code>xinteract</code> command (check the <code>p</code> parameter).</p>

<p>After running the above command, you should see a message like this:</p>

<pre><code>QUIT - the job is incomplete
</code></pre>

<p>You can actually ignore this. What happens here is that TPP analysis looks for a cgi script inside the web interface installation folder and one dependency may not be installed. The error appears after the PeptideProfet and ProteinProphet ends the processing.</p>

<p>Take a look at the <code>input/</code> folder, you will see that now we have some new <em>.pep.xml</em> and <em>.prot.xml</em> files too.</p>

<h2 id="run-dia-umpire-quantification-analysis">5) Run DIA-Umpire Quantification Analysis</h2>

<p>finally, the last part!</p>

<p>We need now to run DIA-Umpire again, but this time using the quantification module. Before running, check the diaumpire.quant_params file, and set the correct values for you.</p>

<pre><code>$ docker run -v /home/felipevl/workspace/input:/data/ biodckr/dia-umpire java -jar -Xmx8G /home/biodocker/bin/DIA-Umpire/DIA_Umpire_Quant.jar /data/diaumpire.quant_params
</code></pre>

<p>The analysis will end with a message like this:</p>

<p><code>Job done</code></p>

<p>And you will notice that now you have 3 more files called PeptideSummary and ProtSummary in .xls format. These are the final results from the pipeline.</p>

<h2 id="final-remarks">Final Remarks</h2>

<p>This example shows how powerful docker can be. We downloaded a fully designed pipeline with all the necessary files and settings ready to use. This will allow people with difficulties in dealing with infrastructure and software configuration to go directly to the analysis step.</p>


           <div id="lower-link-box" class="link-box">
				 
				
					<a href="/containers-examples/Comet/" class="btn btn-primary next-link pull-right">Next</a>
				

				<br />	
			</div>

		</div>
	</div>

<!-- temporaroy removed 

-->

<script>
document.addEventListener("DOMContentLoaded", function() {
	// load highlighted code blocks
    $('pre code').each(function(i, block) {
      hljs.highlightBlock(block);
    });
	jQuery(".collapsible").each(function(i,e){
		collapseStuff(e,"Hide the code", "Display the code");
	});
	/*
	DO NOT show the explanation
	collapseStuff("#explanation","Hide the icon explanation", "Display the icon explanation");
	jQuery("#explanation").css("display", "block");
	*/
});
function collapseStuff(e, textHidden, textDisplayed){
	var divHigh = $(e);
	var children = divHigh.children();
	children.hide();
	var toggleBox = document.createElement("div");
	toggleBox.className = "tutorials-togglebox";
	divHigh.prepend(toggleBox);
	var awesomeIcon = document.createElement("span");
	var awesomeText= document.createElement("span");
	awesomeIcon.className = "tutorials-togglebox-icon glyphicon glyphicon-chevron-down";
	awesomeText.textContent = "Display the code";
	awesomeText.className = "tutorials-togglebox-text";
	toggleBox.appendChild(awesomeIcon);
	toggleBox.appendChild(awesomeText);
	awesomeText.textContent = textDisplayed;
	$(toggleBox).click(function(){
		var codeBox = children;
		var text = divHigh.children().first();
		if( codeBox.css("display") == "none" ){
			codeBox.show(700);
			awesomeText.textContent = textHidden;
			awesomeIcon.className = "tutorials-togglebox-icon glyphicon glyphicon-chevron-up";
		}else{
			codeBox.hide(500);
			awesomeText.textContent = textDisplayed;
			awesomeIcon.className = "tutorials-togglebox-icon glyphicon glyphicon-chevron-down";
		}
	});
};
</script>

<script src="/docs/js/highlight.min.js"></script>

	</div>
		
		</div>
		<!--
		<div class="footer">
			<div class="improve-this-page">
				<span class="glyphicon glyphicon-pencil"></span> <a href="https://github.com/biojs/edu/blob/master/series/containers-examples/10_DIAUmpire.md">Improve this page</a>
			</div>

			<div id="privacy-notice-less" class="privacy-policy">
				Privacy Policy.
			</div>
			<div id="privacy-notice-more"  class="privacy-policy" style="display:none">
				This website uses Google Analytics to collect anonymous visiting stats.<br />
				By visiting this site you agree to the <a href="https://www.google.com/analytics/terms/us.html">data processing agreement</a> by Google.<br />
				If you do not agree, <a href="http://www.usa.gov/optout-instructions.shtml">opt out</a>.
			</div>
		
		</div>
		-->


	<script type="text/javascript" src="/docs/js/jquery.min.js"></script>
	<script type="text/javascript" src="/docs/js/highlight.min.js"></script>
	<script type="text/javascript" src="/docs/js/jquery-scrollspy.js"></script>
	<script type="text/javascript" src="/docs/js/bottom.js"></script>
	<script type="text/javascript" src="/docs/js/bootstrap.min.js"></script>

			<script type="text/javascript">
	        $(document).ready(function() {
        			$('.color').each(function(i) {
        				var position = $(this).position();
        				console.log(position);
        				console.log('min: ' + position.top + ' / max: ' + parseInt(position.top + $(this).height()));
        				$(this).scrollspy({
        					min: position.top,
        					max: position.top + $(this).height(),
        					onEnter: function(element, position) {
        						if(console) console.log('entering ' +  element.id);
        						$("body").css('background-color', element.id);
        					},
        					onLeave: function(element, position) {
        						if(console) console.log('leaving ' +  element.id);
        					//	$('body').css('background-color','#eee');
        					}
        				});
        			});
        		});
        	</script>
	<script type="text/javascript">

		/*
		$(window).scroll(function(){
    		$(".topNavbar").css({"top": ($(window).scrollTop()) + "px"});        
    		if ($(window).scrollTop() > 140){
	    		$(".leftPanel").css({"top": ($(window).scrollTop()) -140 + "px"});
			}
    	});
    	*/

		$('.pullButton').click(function(e){
			$("#biojs-menu").css("display","block");
			$("#biojs-main-content").css("margin-left","220px");
			$(".pullButton").removeClass("pullButton-mob");
			e.stopPropagation();
			return false;
		});

		$(window).click(function(){
			closeMenu();
		});
		$('.Menu').click(function(){
			closeMenu();
		});

		function closeMenu(){
			if(isMobile()){
				$("#biojs-menu").css("display","none");
				$(".pullButton").addClass("pullButton-mob");
				$("#biojs-main-content").css("margin-left","0px");
			}
		}
		function isMobile(){
			return $(window).width() <= 600;
		}

	</script>


	


	<script>hljs.initHighlightingOnLoad();</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51509688-5', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
